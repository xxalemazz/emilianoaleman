)

try:
    # Conectar a la base de datos
    connection = pyodbc.connect(connection_string)
    print("Conexión exitosa.")

    # Consulta SQL
    query = "SELECT * FROM Productos"  # Asegúrate de que la tabla exista

    # Leer los datos en un DataFrame de pandas
    df = pd.read_sql(query, connection)

    # Exportar a CSV
    df.to_csv("productos.csv", index=False)
    print("Datos exportados a productos.csv")

    # Exportar a XML
    df.to_xml("productos.xml", index=False)
    print("Datos exportados a productos.xml")

except Exception as e:
    print("Error al conectar o ejecutar la consulta:", e)

finally:
    # Cerrar la conexión
    if 'connection' in locals():
        connection.close()
